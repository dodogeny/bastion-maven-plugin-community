package io.github.dodogeny.security.database.repository;

import io.github.dodogeny.security.model.Vulnerability;

import java.util.List;
import java.util.Optional;

/**
 * Repository Pattern: Abstraction for vulnerability data access.
 * Enables swappable storage backends (JDBC, in-memory, NoSQL, etc.)
 */
public interface VulnerabilityRepository {

    /**
     * Saves a vulnerability to the repository.
     */
    void save(Vulnerability vulnerability);

    /**
     * Saves multiple vulnerabilities in batch.
     */
    void saveAll(List<Vulnerability> vulnerabilities);

    /**
     * Finds a vulnerability by its CVE ID.
     */
    Optional<Vulnerability> findByCveId(String cveId);

    /**
     * Finds all vulnerabilities for a session.
     */
    List<Vulnerability> findBySessionId(String sessionId);

    /**
     * Finds vulnerabilities by severity.
     */
    List<Vulnerability> findBySeverity(String severity);

    /**
     * Finds vulnerabilities for a specific dependency.
     */
    List<Vulnerability> findByDependency(String groupId, String artifactId);

    /**
     * Gets all vulnerabilities.
     */
    List<Vulnerability> findAll();

    /**
     * Counts total vulnerabilities.
     */
    long count();

    /**
     * Counts vulnerabilities by severity.
     */
    long countBySeverity(String severity);

    /**
     * Deletes vulnerabilities for a session.
     */
    void deleteBySessionId(String sessionId);

    /**
     * Deletes all vulnerabilities.
     */
    void deleteAll();

    /**
     * Checks if a vulnerability exists.
     */
    boolean exists(String cveId, String sessionId);
}
