package io.github.dodogeny.security.scanner.patterns;

import io.github.dodogeny.security.model.Vulnerability;

import java.util.List;

/**
 * Chain of Responsibility Pattern: Processes vulnerabilities through a pipeline.
 * Each processor handles one aspect of vulnerability processing.
 */
public interface VulnerabilityProcessor {

    /**
     * Processes a single vulnerability.
     *
     * @param vulnerability The vulnerability to process
     * @return The processed vulnerability (may be modified or null if filtered)
     */
    Vulnerability process(Vulnerability vulnerability);

    /**
     * Processes multiple vulnerabilities.
     *
     * @param vulnerabilities The list of vulnerabilities to process
     * @return The processed list (may be filtered or modified)
     */
    default List<Vulnerability> processAll(List<Vulnerability> vulnerabilities) {
        return vulnerabilities.stream()
            .map(this::process)
            .filter(v -> v != null)
            .collect(java.util.stream.Collectors.toList());
    }

    /**
     * Gets the processor name for logging/debugging.
     */
    String getName();

    /**
     * Gets the processing order (lower = earlier).
     */
    default int getOrder() {
        return 100;
    }

    /**
     * Checks if this processor is enabled.
     */
    default boolean isEnabled() {
        return true;
    }
}
